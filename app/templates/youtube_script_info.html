<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¸ í˜ì‹ ì˜ í‚¹ë£¡ì¤€</title>
    <link rel="stylesheet" href = "{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<div class="container">
     <h1>â–¶ï¸ YouTube ì˜ìƒ ì•…ë³´ ì¶”ì¶œ</h1>
    <form action="/youtube_script" method="post" onsubmit="return validateTimeRange()">
        <label>ì œëª© (í•„ìˆ˜):</label>
        <input type="text" name="title" required><br>

        <label>YouTube URL (í•„ìˆ˜):</label>
        <input type="text" name="url" required><br>

        <label>ì‹œì‘ ì‹œê°„ (ì„ íƒ):</label>
        <input
                type="text"
                name="start_time"
                placeholder="ì˜ˆ: 01:00"
                pattern="^\d{2}:\d{2}$"
                oninvalid="this.setCustomValidity('ì‹œì‘ ì‹œê°„ì€ 00:00 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”')"
                oninput="formatTime(this)"
                maxlength="5"
        /><br>

        <label>ì¢…ë£Œ ì‹œê°„ (ì„ íƒ):</label>
        <input
                type="text"
                name="end_time"
                placeholder="ì˜ˆ: 03:00"
                pattern="^\d{2}:\d{2}$"
                oninvalid="this.setCustomValidity('ì¢…ë£Œ ì‹œê°„ì€ 00:00 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”')"
                oninput="formatTime(this)"
                maxlength="5"
        /><br>

        <button type="submit">ê°€ì´ë“œ ì´ë¯¸ì§€ ìƒì„±</button>
    </form>
</div>

<script>
    function validateTimeRange() {
        const start = document.getElementsByName("start_time")[0].value;
        const end = document.getElementsByName("end_time")[0].value;

        if (!start || !end) return true;

        const [sMin, sSec] = start.split(":").map(Number);
        const [eMin, eSec] = end.split(":").map(Number);

        const startSec = sMin * 60 + sSec;
        const endSec = eMin * 60 + eSec;

        if (endSec - startSec > 420) {
            alert("ìµœëŒ€ 7ë¶„ê¹Œì§€ë§Œ í—ˆìš©ë©ë‹ˆë‹¤ (ì‹œì‘~ì¢…ë£Œ).");
            return false;
        }

        if (endSec <= startSec) {
            alert("ì¢…ë£Œ ì‹œê°„ì´ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.");
            return false;
        }

        return true;
    }

    function formatTime(input) {
        const pos = input.selectionStart;
        let raw = input.value.replace(/\D/g, '');

        if (raw.length >= 3) {
            input.value = raw.slice(0, 2) + ':' + raw.slice(2, 4);
        } else {
            input.value = raw;
        }

        let newPos = input.value.length;
        input.setSelectionRange(newPos, newPos);
    }
</script>
</body>
</html>
